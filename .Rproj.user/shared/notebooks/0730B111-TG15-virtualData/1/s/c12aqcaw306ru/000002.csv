"0","if(!file.exists(paste(exptPath,""obs.RData"",sep=""""))|CLEAN.BUILD){"
"0","  set.seed(123)"
"0","  ndays                 <- 2048"
"0","  PAR                   <- VSEMcreatePAR(1:ndays)"
"0","  refPars               <- VSEMgetDefaults()"
"0","  nvar                  <-  nrow(refPars)+1"
"0","  ## add SD"
"0","  refPars[nvar,]          <- c(0.1, 0.001, 0.5)"
"0","  rownames(refPars)[nvar] <- ""error-coeffVar"""
"0","  ## calculate 'true' output and pseudodata"
"0","  referenceData         <- VSEM(refPars$best[1:(nvar-1)], PAR)"
"0","  obs                   <- referenceData + rnorm(length(referenceData), sd = (abs(referenceData) + 1E-7) * refPars$best[nvar])"
"0","  ## set the minimum sd for NEE to 5 kgC /m^2 /day. This is to avoid very small uncertainty for NEE values close to zero"
"0","  obs[,1] <- referenceData[,1] + rnorm(length(referenceData[,1]), sd = pmax((abs(referenceData[,1]) + 1E-7) * refPars$best[nvar],0.0005))"
"0","  save(nvar,ndays,PAR,refPars,referenceData,obs,file=paste(exptPath,""obs.RData"",sep=""""))"
"0","  if(PLOT.DIAGNOSTICS){"
"0","    par(mfrow=c(3,1))"
"0","    for(i in 1:3){"
"0","      plot(obs[,i])"
"0","      lines(referenceData[,i],col=3,lwd=3)"
"0","    }"
"0","  }"
"0","} else {"
"0","  load(paste(exptPath,""obs.RData"",sep=""""))"
"0","  rownames(refPars)[nvar] <- ""error-coeffVar"""
"0","}"
